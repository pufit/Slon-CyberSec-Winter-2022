# День третий (Prototype Pollution)
-- -
### Цель атаки: 
Reflected XSS / Classic XSS

### Решение:

Атака строится на слабой архитектуре ООП в JavaScript. При неудачно написанном коде злоумышленник может получить доступ
к объекту `object.prototype` в браузере своей жерты. Благодаря подмене полей у прототипа и использовании гаджетов сайта
можно добиться XSS уязвимости. Используя любой сканер гаджетов находим на сайте подверженный уязвимости гаджет Lodash.
Более того, из-за специфики сайта находим в JS коде место `data[user][key] = value`. Можем использовать это место для
эскалирования XSS на всех пользователей, зашедших на сайт

### Итоговый эксплоит:
Reflected XSS:
```
http://<url>?__proto__[sourceURL]=%E2%80%A8%E2%80%A9alert(1)
```

Classic XSS:
Регистрируем пользователя `__proto__`, от его имени создаем заметку с ключем `sourceURL` и значением   alert(1)


### Инструменты и полезные ссылки
- Все известные на текущий момент гаджеты https://github.com/BlackFan/client-side-prototype-pollution
- Практика поиска https://habr.com/ru/company/huawei/blog/547178/

### Способ защиты
- Не использовать подверженные атаке гаджеты.
- `Object.create(null)` вместо `{}` когда хотим хранить пользовательский ввод.
